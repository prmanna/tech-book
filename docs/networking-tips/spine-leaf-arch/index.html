<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Intro # What Is Spine-leaf Architecture? # The spine-leaf architecture consists of only two layers of switches: spine and leaf switches. The spine layer consists of switches that perform routing and work as the core of the network. The leaf layer involves access switches that connect to servers, storage devices, and other end-users. This structure helps data center networks reduce hop count and reduce network latency.
In the spine-leaf architecture, each leaf switch is connected to each spine switch."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Spine-leaf Architecture Basics"><meta property="og:description" content="Intro # What Is Spine-leaf Architecture? # The spine-leaf architecture consists of only two layers of switches: spine and leaf switches. The spine layer consists of switches that perform routing and work as the core of the network. The leaf layer involves access switches that connect to servers, storage devices, and other end-users. This structure helps data center networks reduce hop count and reduce network latency.
In the spine-leaf architecture, each leaf switch is connected to each spine switch."><meta property="og:type" content="article"><meta property="og:url" content="https://prasenjitmanna.com/tech-book/docs/networking-tips/spine-leaf-arch/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-04-18T23:41:18+05:30"><title>Spine-leaf Architecture Basics | Technical Book</title><link rel=manifest href=/tech-book/manifest.json><link rel=icon href=/tech-book/favicon.png type=image/x-icon><link rel=stylesheet href=/tech-book/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css integrity="sha256-RhgbyTN1upMgJudTs3xA5v+LsWqe93DHi8xmPkV3sbo=" crossorigin=anonymous><script defer src=/tech-book/flexsearch.min.js></script>
<script defer src=/tech-book/en.search.min.28b23b63090758ec8354d2306366606d504a6c4900836e3ed7b2f68dc009636d.js integrity="sha256-KLI7YwkHWOyDVNIwY2ZgbVBKbEkAg24+17L2jcAJY20=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/tech-book/><img src=/tech-book/logo.png alt=Logo><span>Technical Book</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-374f93193c235d5a59a63115829f835e class=toggle>
<label for=section-374f93193c235d5a59a63115829f835e class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/algorithms/>Algorithms</a></label><ul><li><input type=checkbox id=section-f6b4293ac79e9f284ef5649e49e3639f class=toggle>
<label for=section-f6b4293ac79e9f284ef5649e49e3639f class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/algorithms/breadth-first-search/>Breadth First Search</a></label></li><li><input type=checkbox id=section-2f77d5839f14fc16598e51884edf9cc7 class=toggle>
<label for=section-2f77d5839f14fc16598e51884edf9cc7 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/algorithms/depth-first-search/>Depth First Search</a></label></li><li><input type=checkbox id=section-8729b110b30a06da65be45e52f9e3fb7 class=toggle>
<label for=section-8729b110b30a06da65be45e52f9e3fb7 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/algorithms/easy/>Easy Complexity</a></label></li><li><input type=checkbox id=section-ca21930662bb4a3bb727e300c49e2d9e class=toggle>
<label for=section-ca21930662bb4a3bb727e300c49e2d9e class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/algorithms/priority-queue-and-heap/>Priority Queue and Heap</a></label></li><li><input type=checkbox id=section-099794dc84dde9d1e65baa1aa530d340 class=toggle>
<label for=section-099794dc84dde9d1e65baa1aa530d340 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/algorithms/two-pointers/>Two Pointers & Sliding Window</a></label></li><li><input type=checkbox id=section-df4c4c540e3dcef48dcd2d00c3965057 class=toggle>
<label for=section-df4c4c540e3dcef48dcd2d00c3965057 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/algorithms/medium/>Medium Complexity</a></label></li></ul></li><li><input type=checkbox id=section-c0873fdd42e1c17c1e07645e6ab51cc6 class=toggle>
<label for=section-c0873fdd42e1c17c1e07645e6ab51cc6 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/data-center/>Data Center Tips</a></label><ul><li><input type=checkbox id=section-b410e2827c97ad7292e88e649356e4bb class=toggle>
<label for=section-b410e2827c97ad7292e88e649356e4bb class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/data-center/data-center-technologies/>Data Center Technologies</a></label></li></ul></li><li><input type=checkbox id=section-7e26b4da67ddfd3aaa6c31b6861a89ab class=toggle>
<label for=section-7e26b4da67ddfd3aaa6c31b6861a89ab class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/manageability/>Manageability</a></label><ul><li><input type=checkbox id=section-207ca266e79d5be472b6432e1fb17bc9 class=toggle>
<label for=section-207ca266e79d5be472b6432e1fb17bc9 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/manageability/why-grpc-on-http2/>gRPC on HTTP/2</a></label></li></ul></li><li><input type=checkbox id=section-fb52063de722764b4360edb4a8e12aac class=toggle checked>
<label for=section-fb52063de722764b4360edb4a8e12aac class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/networking-tips/>Networking Tips</a></label><ul><li><input type=checkbox id=section-c0c77ea3665f75e8725762e5f6c3df5f class=toggle>
<label for=section-c0c77ea3665f75e8725762e5f6c3df5f class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/networking-tips/ecmp/>ECMP Load Balancing</a></label></li><li><input type=checkbox id=section-08ea5842f5de2b61898b3331283f5a5d class=toggle>
<label for=section-08ea5842f5de2b61898b3331283f5a5d class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/networking-tips/ip-tos-dscp/>IP Precedence And TOS | DSCP</a></label></li><li><input type=checkbox id=section-3df6ef15c6f2aa5dd3d67f5088d745be class=toggle>
<label for=section-3df6ef15c6f2aa5dd3d67f5088d745be class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/networking-tips/mlag/>Multi Chassis Link Aggregation Basics</a></label></li><li><input type=checkbox id=section-47cc7aa07b55b4be11fe16f855d483d8 class=toggle>
<label for=section-47cc7aa07b55b4be11fe16f855d483d8 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/networking-tips/qos/>QoS</a></label></li><li><input type=checkbox id=section-9b2532f62af98602d9328253e60fe7f9 class=toggle checked>
<label for=section-9b2532f62af98602d9328253e60fe7f9 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/networking-tips/spine-leaf-arch/ class=active>Spine-leaf Architecture Basics</a></label></li><li><input type=checkbox id=section-9ff3d0dfa529a2a96fb5ed7225cc4dd8 class=toggle>
<label for=section-9ff3d0dfa529a2a96fb5ed7225cc4dd8 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/networking-tips/tcp-congestion/>TCP Congestion Control</a></label></li></ul></li><li><input type=checkbox id=section-ea5c43baf485397e13cba9de36dde795 class=toggle>
<label for=section-ea5c43baf485397e13cba9de36dde795 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/programming-tips/>Programming Tips</a></label><ul><li><input type=checkbox id=section-15ee98aa89ade27055dc2c8d1cc12212 class=toggle>
<label for=section-15ee98aa89ade27055dc2c8d1cc12212 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/programming-tips/c++/>C++ Tips</a></label></li></ul></li><li><input type=checkbox id=section-e1ca16f5998b918e4e01f395e9c81195 class=toggle>
<label for=section-e1ca16f5998b918e4e01f395e9c81195 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/systemdesign-tips/>SystemDesign-Tips</a></label><ul><li><input type=checkbox id=section-cd24c01774f2ef0254c419c2af253650 class=toggle>
<label for=section-cd24c01774f2ef0254c419c2af253650 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/systemdesign-tips/code-deployment-system/>Design A Code-Deployment System</a></label></li><li><input type=checkbox id=section-9c8d84ec532d2a2d7bafc9a630fe088a class=toggle>
<label for=section-9c8d84ec532d2a2d7bafc9a630fe088a class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/systemdesign-tips/stock-broker/>Design A Stock-Broker System</a></label></li><li><input type=checkbox id=section-0f676c3118d30de407a723723e27de91 class=toggle>
<label for=section-0f676c3118d30de407a723723e27de91 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/systemdesign-tips/design-amazon/>Design Amazon</a></label></li><li><input type=checkbox id=section-de7910a662f896155a583da23f7844c9 class=toggle>
<label for=section-de7910a662f896155a583da23f7844c9 class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/systemdesign-tips/design-slack/>Design Slack</a></label></li><li><input type=checkbox id=section-81d594663dd77ffbd855c8bfc64baf2e class=toggle>
<label for=section-81d594663dd77ffbd855c8bfc64baf2e class="flex justify-between"><a href=https://prasenjitmanna.com/tech-book/docs/systemdesign-tips/google-drive/>Google Drive - Design</a></label></li></ul></li></ul><ul><li><a href=/tech-book/posts/>Blog</a></li><li><a href=https://prasenjitmanna.com/tech-book/ target=_blank rel=noopener>Technical Book</a></li><li><a href=https://prasenjitmanna.com/ target=_blank rel=noopener>Prasenjit's blog</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/tech-book/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Spine-leaf Architecture Basics</strong>
<label for=toc-control><img src=/tech-book/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#intro>Intro</a><ul><li><a href=#what-is-spine-leaf-architecture>What Is Spine-leaf Architecture?</a></li><li><a href=#why-use-spine-leaf-architecture>Why Use Spine-leaf Architecture?</a></li><li><a href=#spine-leaf-vs-traditional-three-tier-architecture>Spine-leaf vs. Traditional Three-Tier Architecture</a></li><li><a href=#how-to-design-spine-leaf-architecture>How to Design Spine-leaf Architecture?</a></li><li><a href=#design-considerations-of-spine-leaf-architecture>Design Considerations of Spine-leaf Architecture</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=intro>Intro
<a class=anchor href=#intro>#</a></h1><h2 id=what-is-spine-leaf-architecture>What Is Spine-leaf Architecture?
<a class=anchor href=#what-is-spine-leaf-architecture>#</a></h2><p>The spine-leaf architecture consists of only two layers of switches: spine and leaf switches. The spine layer consists of switches that perform routing and work as the core of the network. The leaf layer involves access switches that connect to servers, storage devices, and other end-users. This structure helps data center networks reduce hop count and reduce network latency.</p><p>In the spine-leaf architecture, each leaf switch is connected to each spine switch. With this design, any server can communicate with any other server, and there is no more than one interconnected switch path between any two leaf switches.</p><p><img src=https://prasenjitmanna.com/tech-book/diagrams/577kf_1HGFbK.jpg alt=img|320x271></p><h2 id=why-use-spine-leaf-architecture>Why Use Spine-leaf Architecture?
<a class=anchor href=#why-use-spine-leaf-architecture>#</a></h2><p>The spine-leaf architecture has become a popular data center architecture, bringing many advantages to the <a href=https://community.fs.com/blog/what-is-a-data-center.html>data center</a>, such as scalability, network performance, etc. The benefits of spine-leaf architecture in modern networks are summarized here in five points.</p><p><strong>Increased redundancy:</strong> The spine-leaf architecture connects the servers with the core network, and has higher flexibility in hyper-scale data centers. In this case, the leaf switch can be deployed as a bridge between the server and the core network. Each leaf switch connects to all spine switches, which creates a large non-blocking fabric, increasing the level of redundancy and reducing traffic bottlenecks.</p><p><strong>Increased bandwidth:</strong> The spine-leaf architecture can effectively avoid traffic congestion by applying protocols or techniques such as transparent interconnection of multiple links (TRILL) and shortest path bridging (SPB). The spine-leaf architecture can be Layer 2 or Layer 3, so uplinks can be added to the spine switch to expand inter-layer bandwidth and reduce oversubscription to secure network stability.</p><p><strong>Improve scalability:</strong> The spine-leaf architecture has multiple links that can carry traffic. The addition of switches will improve scalability and help enterprises to expand their business later.</p><p><strong>Reduced expenses:</strong> A spine-leaf architecture increases the number of connections each switch can handle, so data centers require fewer devices to deploy. Many data center networks employ spine-leaf architecture to minimize costs.</p><p><strong>Minimal latency and congestion:</strong> By limiting the maximum number of hops to two between any source and destination nodes, we establish a more direct traffic path, enhancing overall performance and mitigating bottlenecks. The only exception is when the destination is on the same leaf switch.</p><h2 id=spine-leaf-vs-traditional-three-tier-architecture>Spine-leaf vs. Traditional Three-Tier Architecture
<a class=anchor href=#spine-leaf-vs-traditional-three-tier-architecture>#</a></h2><p>The main difference between spine-leaf architecture and 3-tier architecture lies in the number of network layers, and the traffic they transform is north-south or east-west traffic.</p><p>As shown in the following figure, the traditional three-tier network architecture consists of three layers: core, aggregation and access. The access switches are connected to servers and storage devices, the aggregation layer aggregates the access layer traffic, provides redundant connections at the access layer, and the core layer provides network transmission. But this three-layer topology is usually designed for north-south traffic and uses the STP protocol, supporting up to 100 switches. In the case of continuous expansion of network data, this will inevitably result in port blockage and limited scalability.</p><p>The spine-leaf architecture is to add east-west traffic parallelism to the north-south network architecture of the backbone, fundamentally solving the bottleneck problem of the traditional three-tier network architecture. It increases the exchange layer under the access layer, and the data transmission between two nodes is completed directly at this layer, thereby diverting backbone network transmission. Compared with traditional three-tier architecture, the spine-leaf architecture provides a connection through the spine with a single hop between leaves, minimizing any latency and bottle necks. In spine-leaf architectures, the switch configuration is fixed so that no network changes are required for a dynamic server environment.</p><p><img src=https://prasenjitmanna.com/tech-book/diagrams/Meiy5_2HM6Ed.jpg alt=img|320x271></p><h2 id=how-to-design-spine-leaf-architecture>How to Design Spine-leaf Architecture?
<a class=anchor href=#how-to-design-spine-leaf-architecture>#</a></h2><p>Before designing a spine-leaf architecture, you need to figure out some important and relevant considerations, especially the oversubscription rate and the size of the spine switch. Surely, we have also given a detailed example for your reference.</p><h2 id=design-considerations-of-spine-leaf-architecture>Design Considerations of Spine-leaf Architecture
<a class=anchor href=#design-considerations-of-spine-leaf-architecture>#</a></h2><p><strong>Oversubscription rate:</strong> It is the contention rate when all devices are sending traffic at the same time. It can be measured in the north/south direction (traffic entering/leaving the data center) and in the east/west direction (traffic between devices within the data center). The most appropriate oversubscription ratio for modern network architectures is 3:1 or less, which is measured and delineated as a ratio between upstream bandwidth (to backbone switches) and downstream capacity (to servers/storage).</p><p>For example, a leaf switch has 48 x 10G ports for a total of 480Gb/s of port capacity. If you connect 4 x 40G uplink ports from each leaf switch to a 40G spine switch, it will have 160Gb/s of uplink capacity. The ratio is 480:160, or 3:1. However, data center uplinks are typically 40G or 100G and can be migrated over time from a starting point of 40G (Nx 40G) to 100G (Nx 100G). It is important to note that the uplink should always run faster than the downlink to not have port link blockage.</p><p><strong>Leaf and spine sizing:</strong> The maximum number of leaf switches in the topology is determined by the port density of the spine switches. And the number of spine switches will be governed by the combination of the required throughput between the leaf switches, the number of redundant/ECMP (equivalent multipath) paths, and their port density. So the number of spine-leaf switches and port density need to be taken into account to prevent network problems.</p><p><strong>Layer 2 or Layer 3 design:</strong> A two-tier spine-leaf fabric can be built at either Layer 2 (configuring VLANs) or Layer 3 (subnetting). Layer 2 designs need to provide maximum flexibility, allowing VLANs to span anywhere and MAC addresses to migrate anywhere. Layer 3 designs need to provide the fastest convergence times and maximum scale with fan-out ECMP supporting up to 32 or more active spine switches.</p><p><strong>References:</strong></p><ul><li><a href=https://community.fs.com/article/leaf-spine-with-fs-com-switches.html>https://community.fs.com/article/leaf-spine-with-fs-com-switches.html</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/prmanna/tech-book/commit/ee8d5b9c10d23eaf4841f88f0158222b9656a9ac title='Last modified by Prasenjit Manna | April 18, 2024' target=_blank rel=noopener><img src=/tech-book/svg/calendar.svg class=book-icon alt=Calendar>
<span>April 18, 2024</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#intro>Intro</a><ul><li><a href=#what-is-spine-leaf-architecture>What Is Spine-leaf Architecture?</a></li><li><a href=#why-use-spine-leaf-architecture>Why Use Spine-leaf Architecture?</a></li><li><a href=#spine-leaf-vs-traditional-three-tier-architecture>Spine-leaf vs. Traditional Three-Tier Architecture</a></li><li><a href=#how-to-design-spine-leaf-architecture>How to Design Spine-leaf Architecture?</a></li><li><a href=#design-considerations-of-spine-leaf-architecture>Design Considerations of Spine-leaf Architecture</a></li></ul></li></ul></nav></div></aside></main></body></html>